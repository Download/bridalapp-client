define("bridalapp/class",[],function(){function Class(){var name="",parent=null,args=arrayify(arguments);("string"==typeof args[0]||args[0]instanceof String)&&(name=args.shift()),"function"==typeof args[0]&&(parent=args.shift());var classname=name||"klass";if(eval("var klass = function "+classname+"() {this.initialize.apply(this, arguments);}"),klass.classname=classname,klass.superclass=parent,klass.subclasses=[],parent){var subclass=function(){};subclass.prototype=parent.prototype,klass.prototype=new subclass,parent.subclasses.push(klass)}for(var i=0,len=args.length;len>i;i++)addMethods(klass,args[i]);return klass.prototype.initialize||(klass.prototype.initialize=function(){}),klass.prototype.constructor=klass,klass}function argumentNames(e){var t,n,i=e.toString().match(/^[\s\(]*function[^(]*\((.*?)\)/)[1].split(",");for(t=0,n=i.length;n>t;t++)i[t]=i[t].replace(/^\s+/,"").replace(/\s+$/,"");return 1!==n||i[0]?i:[]}function arrayify(e){if(!e)return[];if("toArray"in Object(e))return e.toArray();for(var t=e.length||0,n=new Array(t);t--;)n[t]=e[t];return n}function bind(e){if(arguments.length<3&&void 0===arguments[1])return e;var t=arrayify(arguments),n=t.splice(0,2)[1];return function(){return e.apply(n,t.concat(arrayify(arguments)))}}function wrap(e,t){return function(){return t.apply(this,[bind(e,this)].concat(arrayify(arguments)))}}function addMethods(e,t){function n(e){var t=[];for(var n in e)t.push(n);return t}for(var i,r=e.superclass&&e.superclass.prototype,s=n(t),a=0;i=s[a];a++){var o=t[i];if(r&&"function"==typeof o){var c=argumentNames(o);if(c.length>0&&"$super"===c[0]){var l=o;o=wrap(function(e){return function(){return r[e].apply(this,arguments)}}(i),l),o.valueOf=bind(l.valueOf,l),o.toString=bind(l.toString,l)}}e.prototype[i]=o}}return Class.subclass=function(e,t){if(e){if(e.classname===t)return e;for(var n,i=0;n=e.subclasses[i];i++){if(n.classname===t)return n;var r=Class.subclass(n,t);if(r)return r}}},Class}),define("bridalapp/datastore",["bridalapp/class"],function(e){"use strict";var t=e("DataStore",{initialize:function(e,t,n){this.name=e,this.url=t||"",this.cfg=n||{},this.cfg.listeners=this.cfg.listeners||{},this.cfg.throttle=this.cfg.throttle||{}},on:function(e,t){this.cfg.listeners[e]=this.cfg.listeners[e]||[],this.cfg.listeners[e].push(t)},trigger:function(e){var t=this,n=t.cfg,i=n.listeners[e];if(i){n.throttle[e]||(n.throttle[e]={triggered:Date.now()});var r=n.throttle[e];r.timeout&&Date.now()<r.triggered+250?clearTimeout(r.timeout):r.triggered=Date.now(),r.timeout=setTimeout(function(){for(var e,n=0;e=i[n];n++)e.call(t);r.timeout=null},10)}},off:function(e,t){if(this.cfg.listeners[e]){if(!t){var n=this.cfg.listeners[e];return delete this.cfg.listeners[e],n}for(var i=this.cfg.listeners[e].length-1;i>=0;i--)if(this.cfg.listeners[e][i]===t)return this.cfg.listeners[e].splice(i,1)}},load:function(){return new Promise(function(e){e([])})},count:function(){return new Promise(function(e){e(0)})},save:function(e){return new Promise(function(t){t(void 0===e.length?[e]:e)})},"delete":function(e){return new Promise(function(t){t("length"in e?e:[e])})},toString:function(){return"[Object "+this.constructor.classname+" '"+this.name+"' {url: '"+this.url+"'}]"}});return t.typeFactories={},t.registerType=function(e,n){t.typeFactories[e]||(t.typeFactories[e]=n)},t.fromType=function(e,n,i,r){return t.typeFactories[n](e,i,r)},t.fromUrl=function(e,n,i){if(!n)return null;var r=n.indexOf("://"),s=n.substring(0,r),a="https"===s?"http":s||"http";return t.fromType(e,a,n,i)},t}),define("bridalapp/synchabledatastore",["suid","bridalapp/class","bridalapp/datastore"],function(e,t,n){"use strict";var i=t("SynchableDataStore",n,{initialize:function(e,t,n,i){e(t,n,i)},get:function(e,t,n,i){var r=i?Persistent.clone(this.items()):this.items();return Persistent.page(Persistent.matches(r,e),t,n)},len:function(e){return this.get(e).length},looksSynched:function(){return 0!==this.lastSynched().getTime()&&!(this.createdItems().length||this.updatedItems().length||this.deletedItems().length)},synch:function(){return new Promise(function(e){e()})},isSynching:function(){return!1},lastSynched:function(e){return e||new Date},items:function(){},createdItems:function(){return[]},updatedItems:function(){return[]},deletedItems:function(){return[]},staleItems:function(){return[]},failedItems:function(){return[]},futureItems:function(){return[]},set:function(e){return e},del:function(e){return e},toString:function(e){var t=e();return t=t.substring(0,t.length-2),"[Object "+this.constructor.classname+" '"+this.name+"' {url: '"+this.url+"', lastSynched:"+this.lastSynched()+", items:"+this.items().length+", created:"+this.createdItems().length+", updated:"+this.updatedItems().length+", deleted:"+this.deletedItems().length+", stale:"+this.staleItems().length+", failed:"+this.failedItems().length+"}]"}});return i}),define("bridalapp/persistent",["bridalapp/class","suid"],function(e,t){var n=e("Persistent",{initialize:function(e){this.id=e&&e.id||t(0),this.type=this.constructor.classname,this.version=e&&void 0!==e.version?e.version:null},equals:function(e){return e&&(e instanceof n&&e.id.value===this.id.value||e instanceof t&&e.value===this.id.value||e==this.id.value)},toString:function(){return"[Object "+this.type+" "+this.id.toString()+" v"+this.version+"]"}});return n.revive=function(i,r){var s=r&&"object"==typeof r&&"string"==typeof r.type&&r.type,a=e.subclass(n,s);return a?new a(r):t.revive(i,r)},n.fromJSON=function(e){return JSON.parse(e,n.revive)},n.persistent=function(e){if(1===arguments.length)return e instanceof n&&null!==e.version;for(var t=[],i=0;e=arguments[i];i++)if(n.persistent(e))t.push(e);else if("length"in e)for(var r,s=0;r=e[s];s++)n.persistent(r)&&t.push(r);return t},n.equals=function(e,t,n){return e==t||n&&0===n(e,t)||e&&e.equals&&e.equals(t)||t&&t.equals&&t.equals(e)||"object"==typeof e&&e&&e.valueOf()==t||"object"==typeof t&&t&&t.valueOf()==e},n.indexOf=function(e,t){for(var i,r=0;i=e[r];r++)if(n.equals(i,t))return r;return-1},n.matches=function(e,t){var i=Array.prototype.concat.call(e||[]);if(t)for(var r=i.length-1;r>=0;r--)for(var s in t)t.hasOwnProperty(s)&&((Array.isArray&&Array.isArray(t[s])||t[s]instanceof Array)&&-1===n.indexOf(t[s],e[r][s])||!n.equals(e[r][s],t[s]))&&i.splice(r,1);return i},n.pluck=function(e,t){for(var n,i=[],r=0;n=e[r];r++)void 0!==n[t]&&i.push(n[t]);return i},n.clone=function(e){var t=[];if(arguments.length>1)return n.clone(arguments);if(!("length"in e))return e instanceof n&&e.clone?e.clone():n.fromJSON(JSON.stringify(e));for(var i,t=[],r=0;i=e[r];r++)t.push(n.clone(i));return t},n.page=function(e,t,n){if(t){var i=(n||0)*t,r=n*(t+1);return 0>r||i>=r||i>e.length?[]:e.slice(Math.max(i,0),Math.min(r,e.length))}return e},n.eachArg=function(e,t,i){if("length"in e&&!(e instanceof n)){for(var r,s=[],a=0;r=e[a];a++)s.push.apply(s,n.eachArg(r,t,i));return s}return i.call(t,e)},n}),define("bridalapp/rhaboodatastore",["bridalapp/class","bridalapp/datastore","bridalapp/synchabledatastore","bridalapp/persistent","rhaboo"],function(e,t,n,i){"use strict";var r=e("RhabooDataStore",n,{initialize:function(e,t,n,i){if(e(t,n,i),!this.cfg.rhaboo||!this.cfg.store){var r=n.indexOf("://")+3,s=n.lastIndexOf("/"),a=n.substring(r,s),o=n.substring(s+1);this.cfg.repo||(this.cfg.repo=a),this.cfg.store||(this.cfg.store=o)}},load:function(e,t,n){return new Promise(function(i){i(this.get(e,t,n))})},count:function(){return new Promise(function(e){e(this.len())})},save:function(e){return new Promise(function(t){t(this.set(e))})},"delete":function(e){return new Promise(function(t){t(this.del(e))})},set:function(){var e=i.eachArg(arguments,this,function(e){var t=null,n=i.indexOf(this.db().items,e);return-1===n?this.db().items.push(e):t=this.db().items.splice(n,1,e)[0],n=i.indexOf(this.db().deleted,e),-1!==n&&(t=this.db().deleted.splice(n,1)),t&&(n=i.indexOf(this.db().updated,e),-1===n?this.db().updated.push(t):this.synching&&(n=i.indexOf(this.db().future,e),-1===n?this.db().future.push(e):this.db().future.splice(n,1,e))),[e]});return this.trigger("change"),e},del:function(){var e=i.eachArg(arguments,this,function(e){var t,n=i.indexOf(this.items(),e);if(-1!==n&&(t=this.items().splice(n,1)[0]),i.persistent(e)){if(n=i.indexOf(this.db().updated,e),-1!==n){var r=this.db().updated.splice(n,1);t=t||r}n=i.indexOf(this.db().future,e),-1!==n&&this.db().future.splice(n,1),n=i.indexOf(this.db().deleted,e),-1===n&&this.db().deleted.push(t||e)}return[t||e]});return this.trigger("change"),e},lastSynched:function(e){return e&&this.db().write("lastSynched",e),this.db().lastSynched},items:function(){return this.db().items},createdItems:function(){for(var e,t=[],n=0;e=this.items()[n];n++)i.persistent(e)||t.push(e);return t},updatedItems:function(){return this.db().updated},deletedItems:function(){return this.db().deleted},staleItems:function(){return this.db().stale},failedItems:function(){return this.db().failed},futureItems:function(){return this.db().future},db:function(){if(!this.cfg.rhaboo){this.cfg.rhaboo=Rhaboo.persistent(this.cfg.repo),this.cfg.rhaboo[this.cfg.store]||this.cfg.rhaboo.write(this.cfg.store,{});for(var e,t=0;e=["items","updated","deleted","stale","failed","future"][t];t++)this.db()[e]||this.db().write(e,[]);this.db().lastSynched||this.db().write("lastSynched",new Date(0))}return this.cfg.rhaboo[this.cfg.store]}});return t.registerType("rhaboo",function(e,t,n){return new r(e,t,n)}),r}),define("bridalapp/log",[],function(){function e(){return r}var t,n,i=["log","info","warn","error"],r="console"in this&&console.error?console:{},s={},a={};for(t=0;n=i[t];t++)a[n]=function(){},s[n]=r[n]||a[n];e.level=function(e){if(void 0!==e&&e>=0&&4>=e&&e!==o){o=e;for(var t,n=0;t=i[n];n++)r[t]=n>=e?s[t]:a[t]}return o},e.level.DEBUG=0,e.level.INFO=1,e.level.WARN=2,e.level.ERROR=3,e.level.NONE=4;var o=e.level.DEBUG;return e}),define("bridalapp/restdatastore",["bridalapp/class","jquery","bridalapp/log","bridalapp/persistent","bridalapp/datastore"],function(e,t,n,i,r){"use strict";function s(e,t,n){return new a(e,t,n)}var a=e("RestDataStore",r,{initialize:function(e,t,n,i){e(t,n,i),this.cfg.retryCount=this.cfg.retryCount||0,this.cfg.retryWaitTime=this.cfg.retryWaitTime||2e3,this.cfg.timeout=this.cfg.timeout||1e4,void 0===this.cfg.supportsSynch&&(this.cfg.supportsSynch=!1)},load:function(e,t,n){return this.remoteRequest("GET",this.url,{criteria:e,pageSize:t,pageIndex:n})},count:function(e){return new Promise(function(t,n){this.remoteRequest("GET",this.url,{criteria:e}).then(function(e){t(e.length)})["catch"](function(e){n(e)})})},save:function(e){var t=i.eachArg(e,this,function(e){return[e]});return this.remoteRequest("POST",this.url+"/save",t)},"delete":function(e){var t=i.eachArg(e,this,function(e){return[e]});return this.remoteRequest("DELETE",this.url,t)},synch:function(e){return this.remoteRequest("POST",this.url+"/synch",e)},remoteRequest:function(e,r,s){return function(e,r,s,a,o){function c(e){var t="";if(e)if(e.length)t="("+e.length+" items)";else if(e.createdItems){var n=[];e.createdItems.length&&n.push(e.createdItems.length+" created"),e.updatedItems.length&&n.push(e.updatedItems.length+" updated"),e.deletedItems&&e.deletedItems.length&&n.push(e.deletedItems.length+" deleted"),e.deletedIds&&e.deletedIds.length&&n.push(e.deletedIds.length+" deleted"),n.length&&(t="("+n.join(", ")+")")}return t}function l(e,r,s,l,u,d){for(var f="",p=0;p<6-e.length;p++)f+=" ";n().log(" -> "+f+e+" "+r+" "+c(s)),t.ajax(r,{method:e,contentType:"application/json",processData:!1,data:s&&JSON.stringify(s),timeout:a}).done(function(t,s,a){-1!==a.responseText.indexOf("j_security_check")?(n().info("401 "+f+e+" "+r+" "+c(t)+" (LOGIN CHALLENGE)"),l(a,e,r,t,u,d)):(n().info("200 "+f+e+" "+r+" "+c(t)+" (OK)"),o=0,u(i.fromJSON(a.responseText)))}).fail(function(t,i,a){t.statusText=a||i,n().warn(t.status+" "+f+e+" "+r+" "+c(s)+" ("+t.statusText+")"),l(t,e,r,s,u,d)})}function u(e,t,n,i,r,s){var a=e.statusText;switch(status){case 500:case 502:case 503:case 504:if(o>0){d(e,t,n,i,errorHandler,r,s);break}case 200:200==e.status&&(a="Session expired.");default:o=0;var c=new Error(e.status+" "+a);c.status=e.status,c.statusText=a,c.request=e,c.method=t,c.url=n,c.data=i,s(c)}}function d(e,t,n,i,r,s,a){o--;var c=3e3,u=e.getResponseHeader("Retry-After");if(u){var d=parseInt(u,10);isNaN(d)||(c=1e3*d)}setTimeout(function(){l(t,n,i,errorhandler,s,a)},c)}Date.now();return new Promise(function(t,n){if("GET"===e&&s){var i=r.indexOf("#"),a=-1!==i?r.substring(i):"",o=r.indexOf("?"),c=-1!==o?r.substring(o):"";if(s.criteria)for(var d in s.criteria)s.criteria.hasOwnProperty(d)&&(c+=(c?"&":"")+encodeURIComponent(d)+"="+encodeURIComponent(s.criteria[d].toString()));s.pageSize&&(c+=(c?"&":"")+"pg="+s.pageIndex+"&pgsz="+s.pageSize),r=r+c+a,s=void 0}l(e,r,s,u,t,n)})}(e,r,s,this.cfg.timeout,this.cfg.retryCount,this.cfg.retryWaitTime)}});return r.registerType("http",s),r.registerType("https",s),a}),define("bridalapp/named",["bridalapp/class","bridalapp/persistent"],function(e,t){var n=e("Named",t,{initialize:function(e,t){e(t),this.name=t&&t.name||null},toString:function(){return"[Object "+this.type+" '"+this.name+"' "+this.id.toString()+" v"+this.version+"]"}});return n}),define("bridalapp/account",["bridalapp/class","bridalapp/named"],function(e,t){var n=e("Account",t,{initialize:function(e,t){e(t),this.roles=t&&t.roles||[],this.groups=t&&t.groups||[],this.credentials=t&&t.credentials||[]}});return n}),define("bridalapp/brand",["bridalapp/class","bridalapp/named"],function(e,t){var n=e("Brand",t,{initialize:function(e,t){e(t)}});return n}),define("bridalapp/synchrequest",["bridalapp/class"],function(e){var t=e("SynchRequest",{initialize:function(e){this.unsynchedDuration=e&&e.synchDuration||0,this.criteria=e&&e.criteria||null,this.currentIds=e&&e.currentIds||[],this.currentVersions=e&&e.currentVersions||[],this.createdItems=e&&e.createdItems||[],this.updatedItems=e&&e.updatedItems||[],this.deletedItems=e&&e.deletedItems||[]}});return t}),define("bridalapp/synchresponse",["bridalapp/class"],function(e){var t=e("SynchResponse",{initialize:function(e){this.createdItems=e&&e.createdItems||[],this.updatedItems=e&&e.updatedItems||[],this.staleItems=e&&e.staleItems||[],this.failedItems=e&&e.failedItems||[],this.deletedIds=e&&e.deletedIds||[]}});return t}),define("bridalapp/syncheddatastore",["bridalapp/class","jquery","bridalapp/log","bridalapp/persistent","bridalapp/datastore","bridalapp/synchabledatastore","bridalapp/synchrequest","bridalapp/synchresponse"],function(e,t,n,i,r,s,a){"use strict";function o(e,t){for(var n,r,s,a=!1,o=0;n=t[o];o++)s=i.indexOf(e.items(),n),-1===s?(s=i.indexOf(e.deletedItems(),n),-1!==s?n.version!==e.deletedItems()[s].version&&(e.deletedItems().splice(s,1),e.items().push(n)):e.items().push(n),a=!0):n.version!==e.items()[s].version&&(r=e.items().splice(s,1,n)[0],s=i.indexOf(e.updatedItems(),r),-1!==s&&(e.updatedItems().splice(s,1),s=i.indexOf(e.staleItems(),r),-1===s?e.staleItems().push(r):e.staleItems().splice(s,1,r)),a=!0);for(var o=e.items().length-1;o>=0;o--)if(n=e.items()[o],-1===i.indexOf(t,n)&&-1===i.indexOf(e.createdItems(),n)){var r=e.items().splice(o,1)[0];s=i.indexOf(e.updatedItems(),r),-1!==s&&(this.updatedItems().splice(s,1),s=i.indexOf(e.staleItems(),r),-1===staleIdx?e.staleItems().push(r):e.staleItems().splice(s,1,r)),a=!0}a&&e.trigger("change")}function c(e,t){for(var n,r=0;n=t[r];r++){var s=i.indexOf(e.futureItems(),n);if(-1!==s){var a=e.futureItems().splice(s,1)[0];s=i.indexOf(e.updatedItems(),n),-1!==s?e.updatedItems().splice(s,1,n):e.updatedItems().push(n);var o=i.clone(n);for(var c in a)"version"!==c&&(o[c]=a[c]);s=i.indexOf(e.items(),n),-1!==s&&e.items().splice(s,1,o)}else s=i.indexOf(e.updatedItems(),n),-1!==s&&e.updatedItems().splice(s,1),s=i.indexOf(e.items(),n),-1!==s&&e.items().splice(s,1,n)}}function l(e,t){for(var n,r=0;n=t[r];r++){var s=i.indexOf(e.deletedItems(),n);-1!==s&&e.deletedItems().splice(s,1)}}function u(e){var t=e.cfg;return e.synching=new Promise(function(n,r){return e.looksSynched()&&Date.now()<e.lastSynched().getTime()+t.pollInterval?setTimeout(function(){e.synching=!1,n()},0):(e.trigger("synch:started"),void t.remoteDataStore.load().then(function(s){o(e,s);for(var a,u=e.createdItems().concat(),d=0;a=e.updatedItems()[d];d++){var f=i.indexOf(e.items(),a);-1!==f&&u.push(e.items()[f])}var p=e.deletedItems().concat();new Promise(function(n,i){return p.length?void t.remoteDataStore["delete"](p).then(function(t){l(e,t),n()})["catch"](function(e){i(e)}):void n()}).then(function(){new Promise(function(n,i){return u.length?void t.remoteDataStore.save(u).then(function(t){c(e,t),n()})["catch"](function(e){i(e)}):void n()}).then(function(){e.lastSynched(new Date),e.synching=!1,e.synchError=!1,e.trigger("synch:success"),n(),e.trigger("synch:done")})["catch"](function(e){r(e)})})["catch"](function(e){r(e)})})["catch"](function(t){e.synching=!1,e.synchError=t,e.trigger("synch:failed"),r(t),e.trigger("synch:done")}))})}function d(e){e.autoSynchActive||(e.autoSynchActive=!0,setInterval(function(){e.synch()},e.cfg.synchInterval))}var f=e("SynchedDataStore",s,{initialize:function(e,t,i,a){if(e(t,i,a),this.synching=!1,this.synchError=!1,a=this.cfg,void 0===a.autoSynch&&(a.autoSynch=!0),a.synchInterval||(a.synchInterval=3e4),a.pollInterval||(a.pollInterval=18e5),void 0===a.remoteSynch&&(a.remoteSynch=!0),!a.localDataStore||!a.remoteDataStore){var o=i.split("://")[1].split("#");if(!a.localDataStore){var c=o[0].split("/"),l=c[0],u=c.slice(1,c.length-1).join("/"),d=c[c.length-1];a.localDataStore=r.fromType(t,l,l+"://"+u+"/"+d),a.localDataStore instanceof s||n().error(a.localDataStore?"Unable to initialize SynchedDataStore '"+t+"'.Need a synchable datastore for the local side, but "+a.localDataStore+" is not a SynchableDataStore.":"Unable to initialize SynchedDataStore '"+t+"'.Need a synchable datastore for the local side, but could not find a datastore for url '"+o[0]+"'.")}if(!a.remoteDataStore){var f=o[1].split("/"),p=f[0],h=f.slice(1,f.length-1).join("/"),m=f[f.length-1];a.remoteDataStore=r.fromType(t,p,"/"+h+"/"+m),a.remoteDataStore||n().error("Unable to initialize SynchedDataStore '"+t+"'.Need a datastore for the remote side, but could not find a datastore for url '"+o[1]+"'.")}}},synch:function(e,t){this.cfg.autoSynch&&d(this);var r=this,s=r.cfg;return!t&&r.synching?r.synching:(r.synchError=!1,s.remoteDataStore.cfg.supportsSynch?r.synching=new Promise(function(e,o){if(!t&&r.looksSynched()&&Date.now()<r.lastSynched().getTime()+s.pollInterval)return setTimeout(function(){r.synching=!1,e()},0);r.trigger("synch:started");var c=!1,l=new a;l.criteria=s.filter||null,l.createdItems.push.apply(l.createdItems,r.createdItems()),l.updatedItems.push.apply(l.updatedItems,r.updatedItems()),l.deletedItems.push.apply(l.deletedItems,r.deletedItems()),l.currentIds.push.apply(l.currentIds,i.pluck(r.items(),"id")),l.currentVersions.push.apply(l.currentVersions,i.pluck(r.items(),"version")),s.remoteDataStore.synch(l).then(function(t){var s,a,o,l;if(t.deletedIds.length){for(s=0;a=t.deletedIds[s];s++)o=i.indexOf(r.items(),a),-1!==o&&(r.items().splice(o,1),c=!0),o=i.indexOf(r.deletedItems(),a),-1!==o&&r.deletedItems().splice(o,1);n().log("Processed "+t.deletedIds.length+" deleted items.")}if(t.updatedItems.length){for(s=0;l=t.updatedItems[s];s++)if(o=i.indexOf(r.futureItems(),l),-1!==o){var u=r.futureItems().splice(o,1)[0];o=i.indexOf(r.updatedItems(),l),-1!==o?r.updatedItems().splice(o,1,l):r.updatedItems().push(l);var d=i.clone(l);for(var f in u)"version"!==f&&(d[f]=u[f]);o=i.indexOf(r.items(),l),-1!==o&&r.items().splice(o,1,d)}else o=i.indexOf(r.updatedItems(),l),-1!==o?r.updatedItems().splice(o,1):c=!0,o=i.indexOf(r.items(),l),-1!==o?r.items().splice(o,1,l):r.items().push(l);n().log("Processed "+t.updatedItems.length+" updated items.")}if(t.createdItems.length){for(s=0;l=t.createdItems[s];s++)o=i.indexOf(r.items(),l),-1===o?(r.items().push(l),c=!0):r.items().splice(o,1,l);n().log("Processed "+t.createdItems.length+" created items.")}if(t.staleItems.length){for(s=0;l=t.staleItems[s];s++)o=i.indexOf(r.staleItems(),l),-1===o?r.staleItems().push(l):r.staleItems().splice(o,1,l),o=i.indexOf(r.createdItems(),l),-1!==o&&r.createdItems().splice(o,1),o=i.indexOf(r.updatedItems(),l),-1!==o&&r.updatedItems().splice(o,1),o=i.indexOf(r.deletedItems(),l),-1!==o&&r.deletedItems().splice(o,1);n().log("Processed "+t.staleItems.length+" stale items.")}if(t.failedItems.length){for(s=0;l=t.failedItems[s];s++)o=i.indexOf(r.failedItems(),l),-1===o?r.failedItems().push(l):r.failedItems().splice(o,1,l),-1!==i.indexOf(r.createdItems(),l)&&(o=i.indexOf(r.items(),l),-1!==o&&r.items().splice(o,1)),o=i.indexOf(r.updatedItems(),l),-1!==o&&r.updatedItems().splice(o,1),o=i.indexOf(r.deletedItems(),l),-1!==o&&r.deletedItems().splice(o,1);n().log("Processed "+t.failedItems.length+" failed items.")}r.lastSynched(new Date),r.synching=!1,c&&r.trigger("change"),r.trigger("synch:success"),e(),r.trigger("synch:done")})["catch"](function(e){r.synching=!1,r.synchError=e,r.trigger("synch:failed"),o(e),r.trigger("synch:done")})}):u(r))},isSynching:function(){return!!this.synching},load:function(e,t,n){var i=this;return new Promise(function(r,s){this.synch().then(function(){i.cfg.localDataStore.load(e,t,n).then(function(e){r(e)})})["catch"](function(e){s(e)})})},count:function(e){var t=this;return new Promise(function(n,i){this.synch().then(function(){t.cfg.localDataStore.count(e,pageSize,pageIndex).then(function(e){n(e)})["catch"](function(e){i(e)})})["catch"](function(e){i(e)})})},save:function(e){var t=this;return new Promise(function(n,i){t.cfg.localDataStore.save(e).then(function(e){t.synch().then(function(){n(e)})["catch"](function(e){i(e)})})["catch"](function(e){i(e)})})},"delete":function(e){var t=this;return new Promise(function(n,i){t.cfg.localDataStore["delete"](e).then(function(e){t.synch().then(function(){n(e)})["catch"](function(e){i(e)})})["catch"](function(e){i(e)})})},lastSynched:function(e){return this.cfg.localDataStore.lastSynched(e)},items:function(){return this.cfg.localDataStore.items()},createdItems:function(){return this.cfg.localDataStore.createdItems()},updatedItems:function(){return this.cfg.localDataStore.updatedItems()},deletedItems:function(){return this.cfg.localDataStore.deletedItems()},staleItems:function(){return this.cfg.localDataStore.staleItems()},failedItems:function(){return this.cfg.localDataStore.failedItems()},futureItems:function(){return this.cfg.localDataStore.futureItems()},set:function(e){return this.cfg.localDataStore.set(e)},del:function(e){return this.cfg.localDataStore.del(e)}});return r.registerType("synched",function(e,t,n){return new f(e,t,n)}),f}),define("bridalapp/brands",["bridalapp/class","bridalapp/syncheddatastore","bridalapp/rhaboodatastore","bridalapp/restdatastore"],function(e,t){var n=e("Brands",t,{initialize:function(e){e("brands","synched://rhaboo/bridal-app/brands#http/api/brands")}});return new n}),define("bridalapp/category",["bridalapp/class","bridalapp/named"],function(e,t){var n=e("Category",t,{initialize:function(e,t){e(t)}});return n}),define("bridalapp/credential",["bridalapp/class","bridalapp/persistent"],function(e,t){var n=e("Credential",t,{initialize:function(e,t){e(t)}});return n}),define("bridalapp/group",["bridalapp/class","bridalapp/named"],function(e,t){var n=e("Group",t,{initialize:function(e,t){e(t),this.description=t&&t.description||null}});return n}),define("bridalapp/password-credential",["bridalapp/class","bridalapp/credential"],function(e,t){var n=e("PasswordCredential",t,{initialize:function(e,t){e(t),this.password=t&&t.password||null}});return n}),define("bridalapp/product",["bridalapp/class","bridalapp/named"],function(e,t){var n=e("Product",t,{initialize:function(e,t){e(t),this.description=t&&t.description||null,this.priceWholesaleEuroCent=t&&t.priceWholesaleEuroCent||null,this.priceConsumerEuroCent=t&&t.priceConsumerEuroCent||null,this.brandId=t&&t.brandId||null,this.brandName=t&&t.brandName||null,this.categoryId=t&&t.categoryId||null,this.categoryName=t&&t.categoryName||null,this.tags=t&&t.tags||null}});return n}),define("bridalapp/products",["bridalapp/class","bridalapp/syncheddatastore","bridalapp/rhaboodatastore","bridalapp/restdatastore"],function(e,t){var n=e("Products",t,{initialize:function(e){e("products","synched://rhaboo/bridal-app/products#http/api/products"),this.cfg.remoteDataStore.cfg.supportsSynch=!0}});return new n}),define("bridalapp/rating",["bridalapp/class","bridalapp/persistent"],function(e,t){var n=e("Rating",t,{initialize:function(e,t){e(t),this.productId=t&&t.productId||null,this.accountId=t&&t.accountId||null,this.score=t&&t.score||null}});return n}),define("bridalapp/ratings",["bridalapp/class","bridalapp/syncheddatastore","bridalapp/rhaboodatastore","bridalapp/restdatastore"],function(e,t){var n=e("Ratings",t,{initialize:function(e){e("ratings","synched://rhaboo/bridal-app/ratings#http/api/ratings"),this.cfg.remoteDataStore.cfg.supportsSynch=!0}});return new n}),define("bridalapp/role",["bridalapp/class","bridalapp/named"],function(e,t){var n=e("Role",t,{initialize:function(e,t){e(t)}});return n}),define("bridalapp",["bridalapp/rhaboodatastore","bridalapp/restdatastore","bridalapp/account","bridalapp/brand","bridalapp/brands","bridalapp/category","bridalapp/credential","bridalapp/group","bridalapp/log","bridalapp/named","bridalapp/password-credential","bridalapp/persistent","bridalapp/product","bridalapp/products","bridalapp/rating","bridalapp/ratings","bridalapp/role"],function(e,t,n,i,r,s,a,o,c,l,u,d,f,p,h,m,g){return{Account:n,Brand:i,Brands:r,Category:s,Credential:a,Group:o,log:c,Named:l,PasswordCredential:u,Persistent:d,Product:f,Products:p,Rating:h,Ratings:m,Role:g,globalize:function(e){for(var t in this)this.hasOwnProperty(t)&&(e[t]=this[t])}}});
//# sourceMappingURL=bridalapp.min.js
//# sourceMappingURL=bridalapp.min.js.map